@using System.Runtime.Serialization.Json
@using Microsoft.AspNet.Identity
@model SongDetails

@{
    if (ViewData.ContainsKey("paramNumerator"))
    {
        <script> var paramNumerator = @ViewBag.paramNumerator; </script>
    }

    var songString = Model.ToJson();
    var filterString = ViewData.ContainsKey("SongFilter") ? ViewBag.SongFilter.ToJson() : null;

    @ScriptHelper.Parameter(ViewData, "NewTempo")
    @ScriptHelper.Parameter(ViewData, "ShowMPM")
    @ScriptHelper.Parameter(ViewData, "ShowBPM")


    var canEdit = User.IsInRole(DanceMusicService.EditRole) ? "true" : "false";
    var canTag = User.Identity.IsAuthenticated ? "true" : "false";
    var userId = User.Identity.GetUserId();
}


<script>
    var paramShowMPM = true;
    var paramShowBPM = true;
    var paramEpsVisible = 0.1;
    var canEdit = @canEdit;
    var canTag = @canTag;
    var song = @Html.Raw(songString);
    var songFilter = @(filterString == null ? null : Html.Raw(filterString));
    var userId = '@userId';
</script>

