@model PagedList.IPagedList<SongBase>
@*@using System.Runtime.Serialization.Json*@

@{
    SongFilter filter = ViewData.ContainsKey("SongFilter") ? ViewBag.SongFilter : SongFilter.AzureSimple;

    var description = filter.Description;

    ViewBag.Title = "Songs for Dancing";
    ViewBag.Description = "music4dance catalog: " + description;

    var dances = (IList<SongCounts>)ViewBag.Dances;

    var userName = filter.UserQuery.IsEmpty ? User.Identity.Name : filter.UserQuery.UserName;
}

@Html.Partial("_SetupFilterScript")

@Html.Partial("ItemTags")

@SongHelper.SearchHeader(Html, filter, dances, userName)

@{ Html.RenderPartial("_ListSongs", @Model, ViewData);}

@SongHelper.Footer(Html, Url, Model, filter)

@if (User.IsInRole("showDiagnostics"))
{
    <div class="row">
        <div class="col-md-12">
            <b>Raw Search Paramters: </b>@WebUtility.UrlDecode(ViewBag.RawSearch.ToString()) 
        </div>
    </div>
}

@section Scripts
{
    @Scripts.Render("~/bundles/jqueryval")
    @Scripts.Render("~/bundles/jqueryautocomplete")
    @Scripts.Render("~/bundles/knockout")
    @Scripts.Render("~/bundles/knockout-mapping")
    @Scripts.Render("~/bundles/tools-script")
    @Scripts.Render("~/bundles/musicservice")
    @Scripts.Render("~/bundles/tagchooser")
    @Scripts.Render("~/bundles/catalog")
    @Scripts.Render("~/bundles/azuresearch")

    @Styles.Render("~/bundles/tools-style")
}
