@using System.Runtime.Serialization.Json
@{
    string filterString = null;
    if (ViewData.ContainsKey("SongFilter"))
    {
        var stream = new MemoryStream();
        var serializer = new DataContractJsonSerializer(typeof(SongFilter));
        serializer.WriteObject(stream, ViewBag.SongFilter);
        filterString = System.Text.Encoding.UTF8.GetString(stream.ToArray());
    }
    var isAuthenticated = User.Identity.IsAuthenticated;
}

<script>
    window.songFilter = @(filterString == null ? null : Html.Raw(filterString));
    window.isAuthenticated = @(isAuthenticated ? "true" : "false");
    if (window.songFilter != null) {
        window.songFilter.raw = '@ViewBag.SongFilter.ToString()';
    }
</script>
